<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python Statements &mdash; Ren&#39;Py Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=c659a740" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/dark.css?v=70edf1c7" />

  
    <link rel="canonical" href="https://www.renpy.org/doc/html/python.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=986d2f06"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
        <script src="_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Conditional Statements" href="conditional.html" />
    <link rel="prev" title="In-Game Menus" href="menus.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

<a href="https://www.renpy.org/" style="margin-bottom: 0">Ren'Py Visual Novel Engine
<img src="_static/navbar-logo.png" alt="Logo" style="width: 93px; height: 100px; border-radius: 0; margin: 0 auto; padding: 0; margin-top: 5px; background-color: unset;" />
</a>

<a href="index.html" style="margin-bottom: 0px">8.3.4 Documentation</a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">GUI Customization Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Ren'Py Language</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="language_basics.html">Language Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="label.html">Labels &amp; Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogue.html">Dialogue and Narration</a></li>
<li class="toctree-l1"><a class="reference internal" href="displaying_images.html">Displaying Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="menus.html">In-Game Menus</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python Statements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#python-statement">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#one-line-python-statement">One-line Python Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#init-python-statement">Init Python Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-statement">Define Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#default-statement">Default Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#names-in-the-store">Names in the Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-named-stores">Other Named Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constant-stores">Constant Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jsondb">JSONDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#JSONDB"><code class="docutils literal notranslate"><span class="pre">JSONDB</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#first-and-third-party-python-modules-and-packages">First and Third-Party Python Modules and Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#injecting-python">Injecting Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="conditional.html">Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio_filters.html">Audio Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="movie.html">Movie</a></li>
<li class="toctree-l1"><a class="reference internal" href="voice.html">Voice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Text, Displayables, Transforms, and Transitions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation.html">Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="displayables.html">Displayables</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_properties.html">Transform Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitions.html">Transitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrixcolor.html">Matrixcolor</a></li>
<li class="toctree-l1"><a class="reference internal" href="layeredimage.html">Layered Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="3dstage.html">3D Stage</a></li>
<li class="toctree-l1"><a class="reference internal" href="live2d.html">Live2D Cubism</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Customizing Ren'Py</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="style.html">Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="style_properties.html">Style Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="screens.html">Screens and Screen Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_actions.html">Screen Actions, Values, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_special.html">Special Screen Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_optimization.html">Screen Language Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="preferences.html">Preference Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="store_variables.html">Store Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="mouse.html">Custom Mouse Cursors</a></li>
<li class="toctree-l1"><a class="reference internal" href="textshaders.html">Text Shaders</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="launcher.html">Launcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_tools.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="director.html">Interactive Director</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Functionality</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nvl_mode.html">NVL-Mode Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="bubble.html">Speech Bubbles</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Text Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="side_image.html">Side Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="rooms.html">Image Gallery, Music Room, and Replay Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="drag_drop.html">Drag and Drop</a></li>
<li class="toctree-l1"><a class="reference internal" href="sprites.html">Sprites</a></li>
<li class="toctree-l1"><a class="reference internal" href="keymap.html">Customizing the Keymap</a></li>
<li class="toctree-l1"><a class="reference internal" href="achievement.html">Achievements</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Dialogue History</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple.html">Multiple Character Dialogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="splashscreen_presplash.html">Splashscreen and Presplash</a></li>
<li class="toctree-l1"><a class="reference internal" href="lifecycle.html">Lifecycle of a Ren'Py game</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python and Ren'Py</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="statement_equivalents.html">Statement Equivalents</a></li>
<li class="toctree-l1"><a class="reference internal" href="save_load_rollback.html">Saving, Loading, and Rollback</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistent.html">Persistent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_advanced.html">Advanced GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_python.html">Screens and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="cdd.html">Creator-Defined Displayables</a></li>
<li class="toctree-l1"><a class="reference internal" href="cds.html">Creator-Defined Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_text_tags.html">Custom Text Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="character_callbacks.html">Character Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_python.html">File Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="color_class.html">Color Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model-Based Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Other Functions and Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="ren_py.html">_ren.py Files - Ren'Py in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetch.html">HTTPS/HTTP Fetch</a></li>
<li class="toctree-l1"><a class="reference internal" href="screenshot.html">Screenshots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Building, Updating, and Other Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="android.html">Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="ios.html">iOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="web.html">Web / HTML5</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromeos.html">Chrome OS/Chromebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="raspi.html">Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="iap.html">In-App Purchasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="updater.html">HTTPS/HTTP Updater</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloader.html">Downloader for Large Games on Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="gesture.html">Gestures</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">End-User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Dealing with Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_variables.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_voicing.html">Self-Voicing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Library and Tool Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="template_projects.html">Template Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Engine Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="editor.html">Text Editor Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="skins.html">Skins</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating_renpy.html">Translating Ren'Py</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changes, License, and Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog (Ren'Py 7.x-)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog6.html">Changelog (Ren'Py 6.11 - 6.99)</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompatible.html">Incompatible Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponsors.html">Ren'Py Development Sponsors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ren'Py Visual Novel Engine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Python Statements</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/renpy/renpy/blob/master/sphinx/source/python.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-statements">
<span id="python"></span><h1>Python Statements<a class="headerlink" href="#python-statements" title="Link to this heading"></a></h1>
<p>Ren'Py is written in the Python programming language, and includes
support for including Python inside Ren'Py scripts. Python
support can be used for many things, from setting a flag to creating
new displayables. This chapter covers ways in which Ren'Py scripts can
directly invoke Python, through the various Python statements.</p>
<p>Ren'Py 7 supports Python 2.7. Ren'Py 8 supports Python 3.9.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you know Python, you'll be able to take advantage of that. However,
not everything you know about Python will apply directly. For example.
Python packages that don't ship with Ren'Py may not work inside Ren'Py.</p>
<p>There are also some Python constructs that work, but may lead to problems
in saving. Please read the <a class="reference internal" href="save_load_rollback.html"><span class="doc">save, load, and rollback</span></a> page
for more details, especially the section on <a class="reference internal" href="save_load_rollback.html#cant-save"><span class="std std-ref">what can't be saved</span></a>.
(You need to be careful with files, sockets, iterators, task, futures, and
generators.)</p>
<p>Finally, while many statements have Python equivalents, those equivalents
can be inferior. For example, Ren'Py can predict the <code class="docutils literal notranslate"><span class="pre">show</span></code> statement,
and load images early, but it can't predict the <a class="reference internal" href="statement_equivalents.html#renpy.show" title="renpy.show"><code class="xref py py-func docutils literal notranslate"><span class="pre">renpy.show()</span></code></a> function.</p>
</div>
<section id="python-statement">
<span id="id1"></span><h2>Python<a class="headerlink" href="#python-statement" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">python</span></code> statement takes a block of Python, and runs the block
when control reaches the statement. A basic Python statement can be
very simple:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">python</span><span class="p">:</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Python statements can get more complex, when necessary:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">python</span><span class="p">:</span>
    <span class="n">player_health</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">player_health</span> <span class="o">-</span> <span class="n">damage</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">enemy_vampire</span><span class="p">:</span>
        <span class="n">enemy_health</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">enemy_health</span> <span class="o">+</span> <span class="n">damage</span><span class="p">,</span> <span class="n">enemy_max_health</span><span class="p">)</span>
</pre></div>
</div>
<p>There are two modifiers to the Python statement that change its
behavior:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">hide</span></code></dt><dd><p>If given the hide modifier, the Python statement will run the
block of Python in an anonymous scope. The scope will be lost when the
Python block terminates.</p>
<p>This allows Python to use temporary variables that can't be
saved – but it means that the store needs to be accessed as fields
on the store object, rather than directly.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">in</span></code></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">in</span></code> modifier takes a name. Instead of executing in the
default store, the Python will execute in the store with that
name.</p>
</dd>
</dl>
</section>
<section id="one-line-python-statement">
<h2>One-line Python Statement<a class="headerlink" href="#one-line-python-statement" title="Link to this heading"></a></h2>
<p>A common case is to have a single line of Python that runs in the
default store. For example, a Python one-liner can be used to
initialize or update a flag. To make writing Python one-liners
more convenient, there is the one-line Python statement.</p>
<p>The one-line Python statement begins with the dollar-sign <code class="docutils literal notranslate"><span class="pre">$</span></code>
character, and contains everything else on that line. Here
are some example of Python one-liners:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set a flag.</span>
<span class="k">$</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Initialize a variable.</span>
<span class="k">$</span> <span class="n">romance_points</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Increment a variable.</span>
<span class="k">$</span> <span class="n">romance_points</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Call a function that exposes Ren&#39;Py functionality.</span>
<span class="k">$</span> <span class="n">renpy</span><span class="o">.</span><span class="n">movie_cutscene</span><span class="p">(</span><span class="s2">&quot;opening.ogv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Python one-liners always run in the default store.</p>
</section>
<section id="init-python-statement">
<span id="id2"></span><h2>Init Python Statement<a class="headerlink" href="#init-python-statement" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">init</span> <span class="pre">python</span></code> statement runs Python at initialization time,
before the game loads. Among other things, this can be used to define
classes and functions, or to initialize styles, config variables, or
persistent data.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">auto_voice_function</span><span class="p">(</span><span class="n">ident</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;voice/&quot;</span> <span class="o">+</span> <span class="n">ident</span> <span class="o">+</span> <span class="s2">&quot;.ogg&quot;</span>

    <span class="n">config</span><span class="o">.</span><span class="n">auto_voice</span> <span class="o">=</span> <span class="n">auto_voice_function</span>

    <span class="k">if</span> <span class="n">persistent</span><span class="o">.</span><span class="n">endings</span> <span class="k">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">persistent</span><span class="o">.</span><span class="n">endings</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="k">init</span> <span class="mi">1</span> <span class="k">python</span><span class="p">:</span>

    <span class="c1"># The bad ending is always unlocked.</span>
    <span class="n">persistent</span><span class="o">.</span><span class="n">endings</span><span class="o">.</span><span class="k">add</span><span class="p">(</span><span class="s2">&quot;bad_ending&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A priority number can be placed between <code class="docutils literal notranslate"><span class="pre">init</span></code> and <code class="docutils literal notranslate"><span class="pre">python</span></code>. When
a priority is not given, 0 is used. Init statements are run in priority
order, from lowest to highest. Init statements of the same priority are run in
Unicode order by filepath, and then from top to bottom within a file.</p>
<p>To avoid conflict with Ren'Py, creators should use priorities in the
range -999 to 999. Priorities of less than 0 are generally used for
libraries and to set up themes. Normal init statements should have a priority
of 0 or higher.</p>
<p>Init python statements also take the <code class="docutils literal notranslate"><span class="pre">hide</span></code> or <code class="docutils literal notranslate"><span class="pre">in</span></code> clauses.</p>
<p>Variables that have their value set in an init python block are not
saved, loaded, and do not participate in rollback. Therefore, these
variables should not be changed after init is over.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Classes created within Ren'py and inheriting nothing or explicitly
inheriting <code class="docutils literal notranslate"><span class="pre">object</span></code>, and subclasses of these classes, do not support
<code class="docutils literal notranslate"><span class="pre">__slots__</span></code>. Trying to do so will misbehave with rollback in older
versions of renpy, and will raise errors in newer versions.</p>
<p>In order to have slotted classes, creators should explicitly subclass
<code class="docutils literal notranslate"><span class="pre">python_object</span></code>, which doesn't support rollback.</p>
</div>
</section>
<section id="define-statement">
<span id="id3"></span><h2>Define Statement<a class="headerlink" href="#define-statement" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">define</span></code> statement sets a single variable to a value at init time.
The variable is treated as constant, and should not be changed after
being set. For example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">e</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="s2">&quot;Eileen&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent (except for some advantages, see below) to:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="s2">&quot;Eileen&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The define statement can take an optional named store (see below), by
prepending it to the variable name with a dot. The store is created
if it doesn't already exist. For example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">character</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="s2">&quot;Eileen&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The define statement can take an optional index, making it possible
to add entries to a dictionary:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">config</span><span class="o">.</span><span class="n">tag_layer</span><span class="p">[</span><span class="s2">&quot;eileen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;master&quot;</span>
</pre></div>
</div>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">=</span></code>, define can take two more operators. The <code class="docutils literal notranslate"><span class="pre">+=</span></code>
operator adds, and is generally used for list concatenaton. The <code class="docutils literal notranslate"><span class="pre">|=</span></code>
or operator is generally used to concatenate sets. For example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">config</span><span class="o">.</span><span class="n">keymap</span><span class="p">[</span><span class="s2">&quot;dismiss&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span> <span class="s2">&quot;K_KP_PLUS&quot;</span> <span class="p">]</span>
<span class="k">define</span> <span class="n">endings</span> <span class="o">|=</span> <span class="p">{</span> <span class="s2">&quot;best_ending&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>One advantage of using the define statement is that it records the
filename and line number at which the assignment occurred, and
makes that available to the navigation feature of the launcher.
Another advantage is that <a class="reference internal" href="developer_tools.html#lint"><span class="std std-ref">Lint</span></a> will be able to check defined
values, for example by detecting whether the same variable is defined
twice, potentially with different values.</p>
<p>Variables that are defined using the define statement are treated
as constant, are not saved or loaded, and should not be changed. This
constant-nature extends to objects reachable through these variables
through field access and subscripting. (Ren'Py does not enforce this,
but will produce undefined behavior when this is not the case.)</p>
</section>
<section id="default-statement">
<span id="id4"></span><h2>Default Statement<a class="headerlink" href="#default-statement" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">default</span></code> statement sets a single variable to a value if that variable
is not defined when the game starts, or after a new game is loaded. For
example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">points</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>When the variable <code class="docutils literal notranslate"><span class="pre">points</span></code> is not defined at game start, this statement is
equivalent to:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">start</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">points</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>When the variable <code class="docutils literal notranslate"><span class="pre">points</span></code> is not defined at game load, it's equivalent to:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">after_load</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">points</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The default statement can take an optional named store (see below), by
prepending it to the variable name with a dot. The store is created
if it doesn't already exist. For example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">default</span> <span class="n">schedule</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>As for the <code class="docutils literal notranslate"><span class="pre">define</span></code> statement, <a class="reference internal" href="developer_tools.html#lint"><span class="std std-ref">Lint</span></a> offers checks and optimizations
related to the <code class="docutils literal notranslate"><span class="pre">default</span></code> statement.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is highly recommended to <code class="docutils literal notranslate"><span class="pre">default</span></code> every variable in your game that is
susceptible to change. If you use <code class="docutils literal notranslate"><span class="pre">init</span> <span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">define</span></code> to declare a
variable, when a player play a game and changes that variable, then goes
back to the main menu and starts a new game, the variable will not have the
value set in <code class="docutils literal notranslate"><span class="pre">init</span> <span class="pre">python</span></code> and so the former game will &quot;leak&quot; in the newly
started one. If you create these variables in the start label instead, they
will be missing when you load a save file that existed before.</p>
</div>
</section>
<section id="names-in-the-store">
<h2>Names in the Store<a class="headerlink" href="#names-in-the-store" title="Link to this heading"></a></h2>
<p>The default place that Ren'Py stores Python variables is called the
store. It's important to make sure that the names you use in the
store do not conflict.</p>
<p>The define statement assigns a value to a variable, even when it's
used to define a character. This means that it's not possible to
use the same name for a character and a flag.</p>
<p>The following faulty script:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">e</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="s2">&quot;Eileen&quot;</span><span class="p">)</span>

<span class="k">label</span> <span class="n">start</span><span class="p">:</span>

    <span class="k">$</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">e</span> <span class="s2">&quot;Hello, world.&quot;</span>

    <span class="k">$</span> <span class="n">e</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">e</span> <span class="s2">&quot;You scored a point!&quot;</span>
</pre></div>
</div>
<p>will not work, because the variable <code class="docutils literal notranslate"><span class="pre">e</span></code> is being used as both a
character and a flag. Other things that are usually placed into
the store are transitions and transforms.</p>
<p>Names beginning with underscore <code class="docutils literal notranslate"><span class="pre">_</span></code> are reserved for Ren'Py's
internal use. In addition, there is an <a class="reference internal" href="reserved.html"><span class="doc">Index of Reserved Names</span></a>.</p>
</section>
<section id="other-named-stores">
<span id="named-stores"></span><h2>Other Named Stores<a class="headerlink" href="#other-named-stores" title="Link to this heading"></a></h2>
<p>Named stores provide a way of organizing Python functions and variables
into modules. By placing Python in named stores, you can minimize the
chance of name conflicts. Each store corresponds to a Python module.
The default store is <code class="docutils literal notranslate"><span class="pre">store</span></code>, while a named store is accessed as
<code class="docutils literal notranslate"><span class="pre">store.named</span></code>.</p>
<p>Named stores can be created using <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">in</span></code> blocks (or their
<code class="docutils literal notranslate"><span class="pre">init</span> <span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">early</span></code> variants), or using <code class="docutils literal notranslate"><span class="pre">default</span></code>,
<code class="docutils literal notranslate"><span class="pre">define</span></code> or <a class="reference internal" href="transforms.html#transform-statement"><span class="std std-ref">transform</span></a> statements. Variables
in can be imported individually using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">store.named</span> <span class="pre">import</span> <span class="pre">variable</span></code>,
and a named store itself can be imported using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">store</span> <span class="pre">import</span> <span class="pre">named</span></code>.</p>
<p>Named stores can be accessed by supplying the <code class="docutils literal notranslate"><span class="pre">in</span></code> clause to
<code class="docutils literal notranslate"><span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">init</span> <span class="pre">python</span></code> (or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">early</span></code>), all of which
run the Python they contain in the given named store.</p>
<p>For example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span> <span class="k">in</span> <span class="n">mystore</span><span class="p">:</span>

    <span class="n">serial_number</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">serial</span><span class="p">():</span>

        <span class="k">global</span> <span class="n">serial_number</span>
        <span class="n">serial_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">serial_number</span>

<span class="k">default</span> <span class="n">character_stats</span><span class="o">.</span><span class="n">chloe_substore</span><span class="o">.</span><span class="n">friends</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Eileen&quot;</span><span class="p">,}</span>

<span class="k">label</span> <span class="n">start</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">serial</span> <span class="o">=</span> <span class="n">mystore</span><span class="o">.</span><span class="n">serial</span><span class="p">()</span>

    <span class="k">if</span> <span class="s2">&quot;Lucy&quot;</span> <span class="k">in</span> <span class="n">character_stats</span><span class="o">.</span><span class="n">chloe_substore</span><span class="o">.</span><span class="n">friends</span><span class="p">:</span>
        <span class="n">chloe</span> <span class="s2">&quot;Lucy is my friend !&quot;</span>
    <span class="k">elif</span> <span class="n">character_stats</span><span class="o">.</span><span class="n">chloe_substore</span><span class="o">.</span><span class="n">friends</span><span class="p">:</span>
        <span class="n">chloe</span> <span class="s2">&quot;I have friends, but Lucy is not one of them.&quot;</span>

    <span class="k">python</span> <span class="k">in</span> <span class="n">character_stats</span><span class="o">.</span><span class="n">chloe_substore</span><span class="p">:</span>
        <span class="n">friends</span><span class="o">.</span><span class="k">add</span><span class="p">(</span><span class="s2">&quot;Jeremy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>From a <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">in</span></code> block, the default &quot;outer&quot; store can be
accessed using either <code class="docutils literal notranslate"><span class="pre">renpy.store</span></code>, or <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">store</span></code>.</p>
<p>Named stores participate in save, load, and rollback in the same way
that the default store does. Special namespaces such as <code class="docutils literal notranslate"><span class="pre">persistent</span></code>,
<code class="docutils literal notranslate"><span class="pre">config</span></code>, <code class="docutils literal notranslate"><span class="pre">renpy</span></code>... do not and never have supported substore creation
within them.</p>
</section>
<section id="constant-stores">
<span id="id5"></span><h2>Constant Stores<a class="headerlink" href="#constant-stores" title="Link to this heading"></a></h2>
<p>A named store can be declared to be constant by setting a variable named <code class="docutils literal notranslate"><span class="pre">_constant</span></code>
to a true value, using, for example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span> <span class="k">in</span> <span class="n">mystore</span><span class="p">:</span>
    <span class="n">_constant</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>When a store is constant, variables in that store are not saved, and objects
reachable solely from those variables do not participate in rollback.</p>
<p>Variables in a constant store can be changed during the init phase. It's only
after init (including statements like <code class="docutils literal notranslate"><span class="pre">define</span></code>, <code class="docutils literal notranslate"><span class="pre">transform</span></code>, etc.) completes
that the store must be treated as constant.</p>
<p>As Ren'Py has no way of enforcing this, it is the responsibility of the creator
to ensure that variables in a constant store do not change after the init phase.</p>
<p>The reason for declaring a store constant is that each store and variable
incurs a small amount of overhead to support saving, loading, and rollback.
A constant store avoids this overhead.</p>
<p>The following stores are declared constant by default:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">_errorhandling</span>
<span class="n">_gamepad</span>
<span class="n">_renpysteam</span>
<span class="n">_warper</span>
<span class="n">audio</span>
<span class="n">achievement</span>
<span class="n">build</span>
<span class="n">director</span>
<span class="n">iap</span>
<span class="k">layeredimage</span>
<span class="n">updater</span>
</pre></div>
</div>
</section>
<section id="jsondb">
<span id="id6"></span><h2>JSONDB<a class="headerlink" href="#jsondb" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="JSONDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JSONDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#JSONDB" title="Link to this definition"></a></dt>
<dd><p>A JSONDB is a two-level database that uses JSON to store its data
It's intended to be used by game developers to store data in a
database that can be version-controlled as part of the game script.
For example, this can store information associated with each
say statement, that can change how a say statement is displayed.</p>
<p>JSONDBs are not intended for data that is changed through or because
of the player's actions. <a class="reference internal" href="persistent.html"><span class="doc">Persistent Data</span></a> or normal save files are
better choices for that data.</p>
<p>The database should only contain data that Python can serialize to
JSON. This includes lists, dictionaries (with strings as keys),
strings, numbers, True, False, and None. See
<a class="reference external" href="https://docs.python.org/3/library/json.html#encoders-and-decoders">the Python documentation</a>
about interoperability, how data converts between the two formats,
and the various associated pitfalls.</p>
<p>The two levels of the database are dictionaries both keyed by strings.
The first level is read only - when a key on the first level dictionary
is accessed, a second level dictionary is created, optionally with
default contents. The second level dictionary is read-write, and
when one of the keys in a second level dictionary is changed,
that change is saved to the database whe the game exits.</p>
<p>Like other persistent data, JSONDBs do not participate in rollback.</p>
<p>A JSONDB should be created during init (in an init python block or
define statement), and will automatically be saved to the disk provided
at least one key in the dictionary is set. For example:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">balloonData</span> <span class="o">=</span> <span class="n">JSONDB</span><span class="p">(</span><span class="s2">&quot;balloon.json&quot;</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="p">{</span> <span class="s2">&quot;enabled&quot;</span> <span class="p">:</span> <span class="kc">False</span> <span class="p">})</span>
</pre></div>
</div>
<p>This creates a JSONDB that is stored in the file balloon.json, and has a
default values. The second leval values can be used as normal dictionaries:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">screen</span> <span class="n">say</span><span class="p">(</span><span class="n">who</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>

    <span class="k">default</span> <span class="n">bd</span> <span class="o">=</span> <span class="n">balloonData</span><span class="p">[</span><span class="n">renpy</span><span class="o">.</span><span class="n">get_translation_identifier</span><span class="p">()]</span>

    <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]:</span>
        <span class="k">use</span> <span class="n">balloon_say</span><span class="p">(</span><span class="n">who</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">use</span> <span class="n">adv_say</span><span class="p">(</span><span class="n">who</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">developer</span><span class="p">:</span>
        <span class="k">textbutton</span> <span class="s2">&quot;Dialogue Balloon Mode&quot;</span><span class="p">:</span>
            <span class="na">action</span> <span class="n">ToggleDict</span><span class="p">(</span><span class="n">bd</span><span class="p">,</span> <span class="s2">&quot;enabled&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The JSONDB constructor takes the following arguments:</p>
<dl class="simple">
<dt><cite>filename</cite></dt><dd><p>The filename the database is stored in. This is relative to the
game directory. It's recommended that the filename end in &quot;.json&quot;.</p>
</dd>
<dt><cite>default</cite></dt><dd><p>If this is not None, it should be a dictionary. When a new second
level dictionary is created, this object is shallow copied and
used to initialized the new dictionary. The new dictionary will
only be saved as part of the database if at least one key in
it is saved.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="first-and-third-party-python-modules-and-packages">
<span id="python-modules"></span><h2>First and Third-Party Python Modules and Packages<a class="headerlink" href="#first-and-third-party-python-modules-and-packages" title="Link to this heading"></a></h2>
<p>Ren'Py can import pure-Python modules and packages. First-party modules
and packages – ones written for the game – can be placed directly
into the game directory. Third party packages can be placed into the
game/python-packages directory.</p>
<p>For example, to install the python-dateutil package, one can change into the
game's base directory, and run the command:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">target</span> <span class="n">game</span><span class="o">/</span><span class="k">python</span><span class="o">-</span><span class="n">packages</span> <span class="k">python</span><span class="o">-</span><span class="n">dateutil</span>
</pre></div>
</div>
<p>In either case, the module or package can be imported from an init python
block:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dateutil.parser</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Python defined in .rpy files is transformed to allow rollback
to work. Python imported from .py files is not. As a result,
objects created in Python will not work with rollback, and
probably should not be changed after creation.</p>
<p>Not all Python packages are compatible with Ren'Py. It's up to you
to audit the packages you install and make sure the packages will
work.</p>
</div>
</section>
<section id="injecting-python">
<span id="exec-py"></span><h2>Injecting Python<a class="headerlink" href="#injecting-python" title="Link to this heading"></a></h2>
<p>Python can be injected into a game at runtime by creating a file named
<code class="docutils literal notranslate"><span class="pre">exec.py</span></code> in the base directory. It's suggested that this file is created
under a different name, edited, and then atomically moved into place.</p>
<p>When Ren'Py sees a file named <code class="docutils literal notranslate"><span class="pre">exec.py</span></code>, it will load the contents of the file,
delete the file, and execute the contents in the game store using Python's
<code class="docutils literal notranslate"><span class="pre">exec</span></code>. This is always done during an interaction.</p>
<p>This is intended to support debugging tools. By default it is enabled when developer
mode is true, but can also be enabled by setting the RENPY_EXEC_PY environment variable.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="menus.html" class="btn btn-neutral float-left" title="In-Game Menus" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="conditional.html" class="btn btn-neutral float-right" title="Conditional Statements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>